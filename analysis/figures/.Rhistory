eps = rnorm(length(x), 0, 0.2)
eps = rnorm(length(x), 0, 0.2)
m = 1
c = 10
s = 2
x = seq(0, 100, 0.1)
y = m / (1 + exp( -(x - c) / s )) + eps
plot(x,y)
lines(x,fitted(nlss), col = 'red')
nlss = nls(formula = y ~ m / (1 + exp( -(x - c) / s ) ),
data = data.frame(x = x, y = y),
start = list(m = 9.1, c = 5, s = 2),
control = nls.control(maxiter = 500))
plot(x,y)
lines(x,fitted(nlss), col = 'red')
rsquared(y, resid(nlss))
m = 2
c = 10
s = 2
x = seq(0, 100, 0.1)
y = m / (1 + exp( -(x - c) / s )) + eps
nlss = nls(formula = y ~ m / (1 + exp( -(x - c) / s ) ),
data = data.frame(x = x, y = y),
start = list(m = 9.1, c = 5, s = 2),
control = nls.control(maxiter = 500))
rsquared = function(y, res) {
tss = (y - mean(y)) %*% (y - mean(y))
rss = res %*% res
1 - rss / tss
}
plot(x,y)
lines(x,fitted(nlss), col = 'red')
rsquared(y, resid(nlss))
m = c(1, 1, 2, 2, 5, 5)
c = c(10, 10, 5, 5, 10, 10)
s = c(1, 1, 2, 2, 2, 2)
hist(eps)
m = c(1, 1, 2, 2, 5, 5)
c = c(10, 10, 5, 5, 10, 10)
s = c(1, 1, 2, 2, 2, 2)
x = seq(0, 100, 0.1)
sigmoid = function(t, m, c, s){
m / (1 + exp(-(t - c) / s))
}
y0 = sigmoid(x, m, c, s)
y0 = sigmoid(x[1], m[1], c[1], s[1])
plot(x, y0)
x = seq(0, 100, 0.1)
y0 = sigmoid(x, m[1], c[1], s[1])
plot(x, y0)
plot(x, y0, ylab = 'f(x)', xlab = 'x')
m = c(1, 1, 2, 2, 5, 5)
c = c(10, 10, 5, 5, 10, 10)
s = c(1, 1, 2, 2, 2, 2)
x = seq(0, 100, 0.1)
y0 = sigmoid(x, m[1], c[1], s[1])
plot(x, y0, ylab = 'f(x)', xlab = 'x')
for (i in 1:length(m)) {
y = m[i] / exp( -(x - c[i]) / s[i] ) + eps
lines(y, x)
}
plot(x, y0, ylab = 'f(x)', xlab = 'x', col = 'grey', pch = 16)
for (i in 1:length(m)) {
y = m[i] / exp( -(x - c[i]) / s[i] ) + eps
lines(x, y)
}
plot(x, y0, ylab = 'f(x)', xlab = 'x', col = 'grey', pch = 16)
for (i in 1:length(m)) {
y = sigmoid(x, m[i], x[i], s[i]) + eps
lines(x, y)
}
plot(x, y0, ylab = 'f(x)', xlab = 'x',
col = 'grey', pch = 16, ylim = c(0, 10))
for (i in 1:length(m)) {
y = sigmoid(x, m[i], x[i], s[i]) + eps
lines(x, y)
}
par(mfrow = c(3, 3))
for (i in 1:length(m)) {
y = sigmoid(x, m[i], x[i], s[i]) + eps
plot(x, y, type = 'l', xlab = 'x', ylab = 'f(x)')
}
par(mfrow = c(2, 3))
for (i in 1:length(m)) {
y = sigmoid(x, m[i], x[i], s[i]) + eps
plot(x, y, type = 'l', xlab = 'x', ylab = 'f(x)')
}
for (i in 1:length(m)) {
y = sigmoid(x, m[i], x[i], s[i]) + eps
nlss = nls(formula = y ~ m / (1 + exp( -(x - c) / s ) ),
data = data.frame(x = x, y = y),
start = list(m = 9.1, c = 5, s = 2),
control = nls.control(maxiter = 500))
r2 = rsquared(y, residuals(nlss))
plot(x, y, type = 'l', xlab = 'x', ylab = 'f(x)')
title(main = sprintf('R^s = %0.2f', r2))
}
for (i in 1:length(m)) {
y = sigmoid(x, m[i], x[i], s[i]) + eps
nlss = nls(formula = y ~ m / (1 + exp( -(x - c) / s ) ),
data = data.frame(x = x, y = y),
start = list(m = 9.1, c = 5, s = 2),
control = nls.control(maxiter = 500))
r2 = rsquared(y, residuals(nlss))
plot(x, y, type = 'l', xlab = 'x', ylab = 'f(x)')
title(main = sprintf('R^2 = %0.2f, m = %d', r2, m))
}
for (i in 1:length(m)) {
y = sigmoid(x, m[i], x[i], s[i]) + eps
nlss = nls(formula = y ~ m / (1 + exp( -(x - c) / s ) ),
data = data.frame(x = x, y = y),
start = list(m = 9.1, c = 5, s = 2),
control = nls.control(maxiter = 500))
r2 = rsquared(y, residuals(nlss))
plot(x, y, type = 'l', xlab = 'x', ylab = 'f(x)')
title(main = sprintf('R^2 = %0.2f, m = %d', r2, m[i]))
}
for (i in 1:length(m)) {
y = sigmoid(x, m[i], x[i], s[i]) + eps
nlss = nls(formula = y ~ m / (1 + exp( -(x - c) / s ) ),
data = data.frame(x = x, y = y),
start = list(m = 9.1, c = 5, s = 2),
control = nls.control(maxiter = 500))
r2 = rsquared(y, residuals(nlss))
plot(x, y, type = 'l', xlab = 'x', ylab = 'f(x)')
title(main = sprintf('R^2 = %0.2f, m = %d \n
c = %d, s = %s
', r2, m[i], c[i], s[i]))
}
title(main = sprintf('R^2 = %0.2f, m = %d
c = %d, s = %s
', r2, m[i], c[i], s[i]))
for (i in 1:length(m)) {
y = sigmoid(x, m[i], x[i], s[i]) + eps
nlss = nls(formula = y ~ m / (1 + exp( -(x - c) / s ) ),
data = data.frame(x = x, y = y),
start = list(m = 9.1, c = 5, s = 2),
control = nls.control(maxiter = 500))
r2 = rsquared(y, residuals(nlss))
plot(x, y, type = 'l', xlab = 'x', ylab = 'f(x)')
title(main = sprintf('R^2 = %0.2f, m = %d
c = %d, s = %s
', r2, m[i], c[i], s[i]))
}
title(main = sprintf('R^2 = %0.2f, m = %d,c = %d, s = %s
', r2, m[i], c[i], s[i]))
for (i in 1:length(m)) {
y = sigmoid(x, m[i], x[i], s[i]) + eps
nlss = nls(formula = y ~ m / (1 + exp( -(x - c) / s ) ),
data = data.frame(x = x, y = y),
start = list(m = 9.1, c = 5, s = 2),
control = nls.control(maxiter = 500))
r2 = rsquared(y, residuals(nlss))
plot(x, y, type = 'l', xlab = 'x', ylab = 'f(x)')
title(main = sprintf('R^2 = %0.2f, m = %d,c = %d, s = %s
', r2, m[i], c[i], s[i]))
}
title(main = sprintf('R^2 = %0.2f, m = %d, \n c = %d, s = %s
', r2, m[i], c[i], s[i]))
for (i in 1:length(m)) {
y = sigmoid(x, m[i], x[i], s[i]) + eps
nlss = nls(formula = y ~ m / (1 + exp( -(x - c) / s ) ),
data = data.frame(x = x, y = y),
start = list(m = 9.1, c = 5, s = 2),
control = nls.control(maxiter = 500))
r2 = rsquared(y, residuals(nlss))
plot(x, y, type = 'l', xlab = 'x', ylab = 'f(x)')
title(main = sprintf('R^2 = %0.2f, m = %d, \n c = %d, s = %s
', r2, m[i], c[i], s[i]))
}
m = c(1, 1, 2, 2, 5, 5)
c = c(10, 10, 5, 5, 10, 10)
s = c(1, 4, 4, 2, 2, 1)
x = seq(0, 100, 0.1)
y0 = sigmoid(x, m[1], c[1], s[1])
par(mfrow = c(2, 3))
for (i in 1:length(m)) {
y = sigmoid(x, m[i], x[i], s[i]) + eps
nlss = nls(formula = y ~ m / (1 + exp( -(x - c) / s ) ),
data = data.frame(x = x, y = y),
start = list(m = 9.1, c = 5, s = 2),
control = nls.control(maxiter = 500))
r2 = rsquared(y, residuals(nlss))
plot(x, y, type = 'l', xlab = 'x', ylab = 'f(x)')
title(main = sprintf('R^2 = %0.2f, m = %d, \n c = %d, s = %s
', r2, m[i], c[i], s[i]))
}
a = c(1, 1, 2, 2, 3, 3)
b = c(0, 5, 2, 2, 4, 4)
for (i in length(a)){
y = b[i] + a[i] * x + eps
plot(x, y)
}
par(mfrow = c(2, 3))
a = c(1, 1, 2, 2, 3, 3)
b = c(0, 5, 2, 2, 4, 4)
for (i in length(a)){
y = b[i] + a[i] * x + eps
plot(x, y)
}
par(mfrow = c(2, 3))
a = c(1, 1, 2, 2, 3, 3)
b = c(0, 5, 2, 2, 4, 4)
for (i in 1:length(a)){
y = b[i] + a[i] * x + eps
plot(x, y)
}
x = rnorm(1001, 0, sd = 0.1)
for (i in 1:length(a)){
y = b[i] + a[i] * x + eps
plot(x, y)
}
x = rnorm(1001, 0, sd = 0.01)
for (i in 1:length(a)){
y = b[i] + a[i] * x + eps
plot(x, y)
}
x = runif(1001, 0, 100)
for (i in 1:length(a)){
y = b[i] + a[i] * x + eps
plot(x, y)
}
x = rnorm(1001, 0, 1)
for (i in 1:length(a)){
y = b[i] + a[i] * x + eps
plot(x, y)
}
lm(y ~ x)
lml = lm(y ~ x)
summary(lml)
rsquared(y, residuals(lml))
for (i in 1:length(a)){
y = b[i] + a[i] * x + eps
lm1 = lm(y ~ x)
r2 = rsquared(y, residuals(lml))
plot(x, y)
title(main = sprintf('R^2 = %0.2f', r2))
}
a = c(1, 1, 2, 2, 3, 3)
b = c(0, 5, 2, 2, 4, 4)
x = rnorm(1001, 0, 1)
for (i in 1:length(a)){
y = b[i] + a[i] * x + eps
lm1 = lm(y ~ x)
r2 = rsquared(y, residuals(lml))
plot(x, y)
title(main = sprintf('R^2 = %0.2f', r2))
}
par(mfrow = c(2, 3))
for (i in 1:length(m)) {
y = sigmoid(x, m[i], x[i], s[i]) + eps
nlss = nls(formula = y ~ m / (1 + exp( -(x - c) / s ) ),
data = data.frame(x = x, y = y),
start = list(m = 9.1, c = 5, s = 2),
control = nls.control(maxiter = 500))
r2 = rsquared(y, residuals(nlss))
plot(x, y, type = 'l', xlab = 'x', ylab = 'f(x)')
title(main = sprintf('R^2 = %0.2f, m = %d, \n c = %d, s = %s
', r2, m[i], c[i], s[i]))
}
m = c(1, 1, 2, 2, 5, 5)
c = c(10, 10, 5, 5, 10, 10)
s = c(1, 4, 4, 2, 2, 1)
x = seq(0, 100, 0.1)
y0 = sigmoid(x, m[1], c[1], s[1])
par(mfrow = c(2, 3))
for (i in 1:length(m)) {
y = sigmoid(x, m[i], x[i], s[i]) + eps
nlss = nls(formula = y ~ m / (1 + exp( -(x - c) / s ) ),
data = data.frame(x = x, y = y),
start = list(m = 9.1, c = 5, s = 2),
control = nls.control(maxiter = 500))
r2 = rsquared(y, residuals(nlss))
plot(x, y, type = 'l', xlab = 'x', ylab = 'f(x)')
title(main = sprintf('R^2 = %0.2f, m = %d, \n c = %d, s = %s
', r2, m[i], c[i], s[i]))
}
for (i in 1:length(m)) {
y = sigmoid(x, m[i], x[i], s[i]) + eps
nlss = nls(formula = y ~ m / (1 + exp( -(x - c) / s ) ),
data = data.frame(x = x, y = y),
start = list(m = 9.1, c = 5, s = 2),
control = nls.control(maxiter = 500))
r2 = rsquared(y, residuals(nlss))
plot(x, y, type = 'l', xlab = 'x', ylab = 'f(x)', col = 'grey40')
lines(x, fitted(nlss), col = 'red20')
title(main = sprintf('R^2 = %0.2f, m = %d, \n c = %d, s = %s
', r2, m[i], c[i], s[i]))
}
par(mfrow = c(2, 3))
for (i in 1:length(m)) {
y = sigmoid(x, m[i], x[i], s[i]) + eps
nlss = nls(formula = y ~ m / (1 + exp( -(x - c) / s ) ),
data = data.frame(x = x, y = y),
start = list(m = 9.1, c = 5, s = 2),
control = nls.control(maxiter = 500))
r2 = rsquared(y, residuals(nlss))
plot(x, y, type = 'l', xlab = 'x', ylab = 'f(x)', col = 'grey40')
lines(x, fitted(nlss), col = 'red40')
title(main = sprintf('R^2 = %0.2f, m = %d, \n c = %d, s = %s
', r2, m[i], c[i], s[i]))
}
par(mfrow = c(2, 3))
for (i in 1:length(m)) {
y = sigmoid(x, m[i], x[i], s[i]) + eps
nlss = nls(formula = y ~ m / (1 + exp( -(x - c) / s ) ),
data = data.frame(x = x, y = y),
start = list(m = 9.1, c = 5, s = 2),
control = nls.control(maxiter = 500))
r2 = rsquared(y, residuals(nlss))
plot(x, y, type = 'l', xlab = 'x', ylab = 'f(x)', col = 'grey40')
lines(x, fitted(nlss), col = 'red')
title(main = sprintf('R^2 = %0.2f, m = %d, \n c = %d, s = %s
', r2, m[i], c[i], s[i]))
}
par(mfrow = c(2, 3))
for (i in 1:length(m)) {
y = sigmoid(x, m[i], x[i], s[i]) + eps
nlss = nls(formula = y ~ m / (1 + exp( -(x - c) / s ) ),
data = data.frame(x = x, y = y),
start = list(m = 9.1, c = 5, s = 2),
control = nls.control(maxiter = 500))
r2 = rsquared(y, residuals(nlss))
plot(x, y, type = 'l', xlab = 'x', ylab = 'f(x)', col = 'grey40')
lines(x, fitted(nlss), col = colores[2])
title(main = sprintf('R^2 = %0.2f, m = %d, \n c = %d, s = %s
', r2, m[i], c[i], s[i]))
}
par(mfrow = c(2, 3))
for (i in 1:length(m)) {
y = sigmoid(x, m[i], x[i], s[i]) + eps
nlss = nls(formula = y ~ m / (1 + exp( -(x - c) / s ) ),
data = data.frame(x = x, y = y),
start = list(m = 9.1, c = 5, s = 2),
control = nls.control(maxiter = 500))
r2 = rsquared(y, residuals(nlss))
plot(x, y, type = 'l', xlab = 'x', ylab = 'f(x)', col = 'grey40')
lines(x, fitted(nlss), col = colores[2], lwd = 2)
title(main = sprintf('R^2 = %0.2f, m = %d, \n c = %d, s = %s
', r2, m[i], c[i], s[i]))
}
plot(x,y)
lines(x,fitted(nlss), col = 'red')
rsquared(y, resid(nlss))
par(mfrow = c(2, 3))
for (i in 1:length(a)){
y = b[i] + a[i] * x + eps
lm1 = lm(y ~ x)
r2 = rsquared(y, residuals(lml))
plot(x, y)
title(main = sprintf('R^2 = %0.2f', r2))
}
m = c(1, 1, 2, 2, 5, 5)
c = c(10, 10, 5, 5, 10, 10)
s = c(1, 4, 4, 2, 2, 1)
x = seq(0, 100, 0.1)
y0 = sigmoid(x, m[1], c[1], s[1])
par(mfrow = c(2, 3))
for (i in 1:length(m)) {
y = sigmoid(x, m[i], x[i], s[i]) + eps
nlss = nls(formula = y ~ m / (1 + exp( -(x - c) / s ) ),
data = data.frame(x = x, y = y),
start = list(m = 9.1, c = 5, s = 2),
control = nls.control(maxiter = 500))
r2 = rsquared(y, residuals(nlss))
plot(x, y, type = 'l', xlab = 'x', ylab = 'f(x)', col = 'grey40')
lines(x, fitted(nlss), col = colores[2], lwd = 2)
title(main = sprintf('R^2 = %0.2f, m = %d, \n c = %d, s = %s
', r2, m[i], c[i], s[i]))
}
coef(nlss)
nlss
i=1
nlss = nls(formula = y ~ m / (1 + exp( -(x - c) / s ) ),
data = data.frame(x = x, y = y),
start = list(m = 9.1, c = 5, s = 2),
control = nls.control(maxiter = 500))
nlss
res_fun
m
sigmoid = function(x, m, c, s){
m / (1 + exp(-(x - c) / s))
}
resf = function(y, m, c, s, x) {
y - sigmoid(x, m, c, s)
}
nls.lm(par=list(m = 4.1, c = 4, s = 0.5),
fn=resf, y = y,
x = x)
nls.lm(par=list(m = 4.1, c = 4, s = 0.5),
fn=resf, y = y,
x = x)
plot(x, sigmoid(x, m, c, s))
resf = function(y, m, c, s, x) {
y - m / (1 + exp(-(x - c) / s))
}
nls.lm(par=list(m = 4.1, c = 4, s = 0.5),
fn=resf, y = y,
x = x)
?nlsLM
nlsLM(formula = y ~ m / (1 + exp( -(x - c) / s ) ),
data = data.frame(x = x, y = y),
start = list(m = 9.1, c = 5, s = 2),
control = nls.lm.control(maxiter = 500)
)
nlsLM(formula = y ~ m / (1 + exp( -(x - c) / s ) ),
data = data.frame(x = x, y = y),
start = list(m = 9.1, c = 1, s = 2),
control = nls.lm.control(maxiter = 500)
)
nlsLM(formula = y ~ m / (1 + exp( -(x - c) / s ) ),
data = data.frame(x = x, y = y),
start = list(m = 2, c = 1, s = 2),
control = nls.lm.control(maxiter = 500)
)
nls(formula = y ~ m / (1 + exp( -(x - c) / s ) ),
data = data.frame(x = x, y = y),
start = list(m = 9.1, c = 5, s = 2),
control = nls.control(maxiter = 500))
pdf('r2_nls_sig_demo.pdf',
width = 9, height = 3)
par(mfrow = c(2, 3))
for (i in 1:length(m)) {
y = sigmoid(x, m[i], x[i], s[i]) + eps
nlss = nls(formula = y ~ m / (1 + exp( -(x - c) / s ) ),
data = data.frame(x = x, y = y),
start = list(m = 9.1, c = 5, s = 2),
control = nls.control(maxiter = 500))
r2 = rsquared(y, residuals(nlss))
plot(x, y, type = 'l', xlab = 'x', ylab = 'f(x)', col = 'grey40')
lines(x, fitted(nlss), col = colores[2], lwd = 2)
title(main = sprintf('R^2 = %0.2f, m = %d, \n c = %d, s = %s
', r2, m[i], c[i], s[i]))
}
dev.off()
par(mfrow = c(2, 3),
mar = c(4,4,3,0.2))
for (i in 1:length(m)) {
y = sigmoid(x, m[i], x[i], s[i]) + eps
nlss = nls(formula = y ~ m / (1 + exp( -(x - c) / s ) ),
data = data.frame(x = x, y = y),
start = list(m = 9.1, c = 5, s = 2),
control = nls.control(maxiter = 500))
r2 = rsquared(y, residuals(nlss))
plot(x, y, type = 'l', xlab = 'x', ylab = 'f(x)', col = 'grey40')
lines(x, fitted(nlss), col = colores[2], lwd = 2)
title(main = sprintf('R^2 = %0.2f, m = %d, \n c = %d, s = %s
', r2, m[i], c[i], s[i]))
}
par(mfrow = c(2, 3),
mar = c(4.3,4,3,0.2))
for (i in 1:length(m)) {
y = sigmoid(x, m[i], x[i], s[i]) + eps
nlss = nls(formula = y ~ m / (1 + exp( -(x - c) / s ) ),
data = data.frame(x = x, y = y),
start = list(m = 9.1, c = 5, s = 2),
control = nls.control(maxiter = 500))
r2 = rsquared(y, residuals(nlss))
plot(x, y, type = 'l', xlab = 'x', ylab = 'f(x)', col = 'grey40')
lines(x, fitted(nlss), col = colores[2], lwd = 2)
title(main = sprintf('R^2 = %0.2f, m = %d, \n c = %d, s = %s
', r2, m[i], c[i], s[i]))
}
par(mfrow = c(2, 3),
mar = c(4,4,3.2,0.2))
for (i in 1:length(m)) {
y = sigmoid(x, m[i], x[i], s[i]) + eps
nlss = nls(formula = y ~ m / (1 + exp( -(x - c) / s ) ),
data = data.frame(x = x, y = y),
start = list(m = 9.1, c = 5, s = 2),
control = nls.control(maxiter = 500))
r2 = rsquared(y, residuals(nlss))
plot(x, y, type = 'l', xlab = 'x', ylab = 'f(x)', col = 'grey40')
lines(x, fitted(nlss), col = colores[2], lwd = 2)
title(main = sprintf('R^2 = %0.2f, m = %d, \n c = %d, s = %s
', r2, m[i], c[i], s[i]))
}
pdf('r2_nls_sig_demo.pdf',
width = 9, height = 6)
par(mfrow = c(2, 3),
mar = c(4,4,3.2,0.2))
for (i in 1:length(m)) {
y = sigmoid(x, m[i], x[i], s[i]) + eps
nlss = nls(formula = y ~ m / (1 + exp( -(x - c) / s ) ),
data = data.frame(x = x, y = y),
start = list(m = 9.1, c = 5, s = 2),
control = nls.control(maxiter = 500))
r2 = rsquared(y, residuals(nlss))
plot(x, y, type = 'l', xlab = 'x', ylab = 'f(x)', col = 'grey40')
lines(x, fitted(nlss), col = colores[2], lwd = 2)
title(main = sprintf('R^2 = %0.2f, m = %d, \n c = %d, s = %s
', r2, m[i], c[i], s[i]))
}
dev.off()
plot(x, y, type = 'l', xlab = 'x', ylab = 'f(x)', col = 'grey60')
pdf('r2_nls_sig_demo.pdf',
width = 9, height = 6)
par(mfrow = c(2, 3),
mar = c(4,4,3.5,0.2))
for (i in 1:length(m)) {
y = sigmoid(x, m[i], x[i], s[i]) + eps
nlss = nls(formula = y ~ m / (1 + exp( -(x - c) / s ) ),
data = data.frame(x = x, y = y),
start = list(m = 9.1, c = 5, s = 2),
control = nls.control(maxiter = 500))
r2 = rsquared(y, residuals(nlss))
plot(x, y, type = 'l', xlab = 'x', ylab = 'f(x)', col = 'grey60')
lines(x, fitted(nlss), col = colores[2], lwd = 2)
title(main = sprintf('R^2 = %0.2f, m = %d, \n c = %d, s = %s
', r2, m[i], c[i], s[i]))
}
dev.off()
